{% extends 'base.html' %}



{% block content %}

   <br>
    <h4>&nbsp;&nbsp;&nbsp;&nbsp;전체 친구 목록 보기</h4>

    <form action="" method="get" id="search_form" class="form-inline my-2 my-lg-0 float-right">
      <input class="form-control mr-sm-2" type="text" placeholder="Search" name="search_key">
      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>&nbsp;&nbsp;&nbsp;
    </form>
    <br>
    <br>
    <br>
    <table class="table table-striped">
        <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Phone</th>
            <th scope="col">Relation</th>
            <th scope="col">최근 연락일</th>
            <th scope="col">연락 예정일</th>
            <th scope="col">최근 메모</th>
            <th scope="col">Connect!</th>
        </tr>
        </thead>
        <tbody>
        {% for object in friends %}
{#            {% if object.user == request.user %}#}
                {# {% if forloop.counter <= 5 %} #}

                <tr>
                    {#        <th scope="row">{{ object.id }}</th>#}
                    {#        <td><a href="{% url 'friend:detail' object.id %}">{{ object.friend_name }}</a></td>#}
                    <td><a href="{% url 'friend:detail' object.id%}"> {{ object.friend_name }}</a></td>
                    <td>{{ object.friend_mobile }}</td>
                    <td>{{ object.friend_relation }}</td>
                    <td id="change{{ object.id }}">{{ object.latest_connect }}</td>
                    <td id="scheduled{{ object.id }}">{{ object.scheduled_connect }}</td>
                    <td class="memo">{{ object.friend_memo }}</td>
                    <td>
                        <BUTTON onclick="connect('{{ object.id }}')" >연락함</BUTTON>
                    </td>
                    {#                    <td><input type="checkbox" aria-label="Checkbox for following text input" id="Connect"></td>#}

                </tr>
{#            {% endif %}#}
        {% endfor %}
        </tbody>
    </table>

<nav aria-label="Page navigation example">
    <ul class="pagination justify-content-center">
        {% if friends.has_previous %}
            <li><a href="?page=1"><<</a></li>
            <p style="margin:0 5px 0 5px"></p>
            <li><a href="?page={{ friends.previous_page_number }}"><</a></li>
            <p style="margin:0 5px 0 5px"></p>
        {% endif %}

        <span class="current">
            Page {{ friends.number }} of {{ friends.paginator.num_pages }}.
        </span>

        {% if friends.has_next %}
            <p style="margin:0 5px 0 5px"></p>
            <li><a href="?page={{ friends.next_page_number }}"> > </a></li>
            <p style="margin:0 5px 0 5px"></p>
            <li><a href="?page={{ friends.paginator.num_pages }}"> >> </a></li>
        {% endif %}
    </span>
    </ul>
</nav>
     <script type="text/javascript">
        function connect(id) {
            $.ajax({
                url: "/connect/" + id,
                method: "GET",
                success: function (result) {
                    $("#change" + id).html(result.latest_connect);
                    $("#scheduled" + id).html(result.scheduled_connect);
                },
                error: function (error) {
                    console.log(error)
                }
            });
        }


    </script>

{% endblock %}
