{% extends 'base.html' %}
{% block head %}
    <style>
        .memo {
            display: inline-block;
            width: 250px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
    </style>

{% endblock %}
{% block title %}
    Connect
{% endblock %}

{% block content %}
    <br>
    <h2><div style="padding: 15px 0px 20px 10px">This Week Connect !</div></h2>
    {% if user.is_authenticated %}
            <p>{{ user.username }}님의 소중한 인연을 한분 한분 더해주세요!</p>
            <br>
            <p>친구 등록 안내</p>
            <p>더욱 더 소중한 인연일수록 A그룹에 가깝게 입력해주세요!</p>
            <p>Connect에서 매일 매일,</p>
            <p>소중한 인연을 이어갈 수 있도록 알려드릴 거에요</p>
            <p>최근 연락일은 부담 없이 생각나는 대략적인 날짜만</p>
            <p>넣어주시면 됩니다 :)</p>
            <br>
            <p>어리석은 사람은 인연을 만나고도 몰라보고</p>
            <p>보통 사람은 인연인 줄 알면서도 놓치고</p>
            <p>현명한 사람은 옷깃만 스쳐도 인연을 살려낸다. -피천득</p>
        {% else %}
            <p>여기는 회원님의 소중한 인연들을 추가하는 페이지에요!</p>
            <br>
            <p>자신의 전화부를 돌아보며 정말 소중한 인연들을 돌아보며</p>
            <p>한분 한분 소중히 더해주시면 됩니다 :) </p>
            <p>과연 나에게 소중한 인연들은 얼마나 될지 궁금하시죠?</p>
            <p>그럼 나중에 회원가입 후 한분 한분 더해주세요!</p>
            <p>회원 가입 이후에 좀 더 자세한 안내를 드릴게요.</p>
            <br>
            <p>어리석은 사람은 인연을 만나고도 몰라보고</p>
            <p>보통 사람은 인연인 줄 알면서도 놓치고</p>
            <p>현명한 사람은 옷깃만 스쳐도 인연을 살려낸다. -피천득</p>
        {% endif %}
    <table class="table table-striped">
        <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Phone</th>
            <th scope="col">Relation</th>
            <th scope="col">최근 연락일</th>
            <th scope="col">연락 예정</th>
            <th scope="col">최근 소식</th>
            <th scope="col">연락하셨나요?</th>
        </tr>
        </thead>
        <tbody>
        {% for object in object_list %}
            {% if object.user == request.user %}
                {# {% if forloop.counter <= 5 %} #}
{#                {% if object.scheduled_connect < datetime.now %}#}
                <tr>
                    {#        <th scope="row">{{ object.id }}</th>#}
                    {#        <td><a href="{% url 'friend:detail' object.id %}">{{ object.friend_name }}</a></td>#}
                    <td><a href="{% url 'friend:detail' object.id%}"> {{ object.friend_name }}</a></td>
                    <td>{{ object.friend_mobile }}</td>
                    <td>{{ object.friend_relation }}</td>
                    <td id="change{{ object.id }}">{{ object.latest_connect }}</td>
                    <td id="scheduled{{ object.id }}">{{ object.scheduled_connect }}</td>
                    <td class="memo">{{ object.recently_comment.comment_contents }}</td>
                     <td>
                        <BUTTON onclick="connect('{{ object.id }}')">연락함</BUTTON>
                    </td>

                    {#                    <td><input type="checkbox" aria-label="Checkbox for following text input" id="Connect"></td>#}

                </tr>
{#                {% endif %}#}
            {% endif %}
        {% endfor %}
        </tbody>
    </table>

    <h2><div style="padding: 15px 0px 20px 10px">This Week Connected !!</div></h2>

    <table class="table table-striped">
        <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Phone</th>
            <th scope="col">Relation</th>
            <th scope="col">최근 연락일</th>
            <th scope="col">연락 예정</th>
            <th scope="col">최근 소식</th>
            <th scope="col">연락하셨나요?</th>
        </tr>
        </thead>
        <tbody>
        {% for object in this_week_connected %}
            {% if object.user == request.user %}
                {# {% if forloop.counter <= 5 %} #}
{#                {% if object.scheduled_connect < datetime.now %}#}
                <tr>
                    {#        <th scope="row">{{ object.id }}</th>#}
                    {#        <td><a href="{% url 'friend:detail' object.id %}">{{ object.friend_name }}</a></td>#}
                    <td><a href="{% url 'friend:detail' object.id%}"> {{ object.friend_name }}</a></td>
                    <td>{{ object.friend_mobile }}</td>
                    <td>{{ object.friend_relation }}</td>
                    <td id="change{{ object.id }}">{{ object.latest_connect }}</td>
                    <td id="scheduled{{ object.id }}">{{ object.scheduled_connect }}</td>
                    <td class="memo">{{ object.recently_comments.comment_contents }}</td>
                     <td>
                        <BUTTON onclick="connect('{{ object.id }}')">연락함</BUTTON>
                    </td>

                    {#                    <td><input type="checkbox" aria-label="Checkbox for following text input" id="Connect"></td>#}

                </tr>
{#                {% endif %}#}
            {% endif %}
        {% endfor %}
        </tbody>
    </table>



    <script type="text/javascript">
        function connect(id) {
            $.ajax({
                url: "/connect/" + id,
                method: "GET",
                success: function (result) {
                    $("#change" + id).html(result.latest_connect);
                    $("#scheduled" + id).html(result.scheduled_connect);
                },
                error: function (error) {
                    console.log(error)
                }
            });
        }


    </script>

{% endblock %}